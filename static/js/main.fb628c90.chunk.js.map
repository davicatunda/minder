{"version":3,"sources":["google-integration/googleConfiguration.ts","pages/core/Logo.tsx","pages/core/nav-bar/NavBarButtonLayout.tsx","pages/core/nav-bar/NavBarRouteButton.tsx","google-integration/autoRefreshToken.ts","google-integration/useLoginLogout.ts","pages/core/nav-bar/NavBarUserButton.tsx","pages/core/useTogglePaletteContext.tsx","pages/core/nav-bar/NavBar.tsx","pages/App.tsx","index.tsx","google-integration/useGoogleAuthProvider.tsx","pages/core/Spacing.tsx"],"names":["GOOGLE_CONFIG","clientId","discoveryDocs","scope","GOOGLE_SCOPES","Logo","size","fill","width","height","viewBox","xmlns","d","NavBarButtonLayout","onClick","startIcon","children","Button","color","className","css","textTransform","disableRipple","Typography","variant","NavBarRouteButton","route","label","theme","useTheme","location","useLocation","history","useHistory","hasSelectedStyle","pathname","push","position","left","spacing","right","bottom","backgroundColor","palette","common","white","refreshTime","authResponse","expires_in","ONE_HOUR","useLoginLogout","useState","isLoggedIn","setIsLoggedIn","authInstance","useGoogleAuthContext","logIn","onSuccess","onFailure","client","useApolloClient","useMutation","gql","signin","onLogin","googleUser","localStorage","setItem","getAuthResponse","id_token","stop","resetStore","then","data","refreshToken","a","reloadAuthResponse","newAuthRes","setTimeout","autoRefreshToken","useEffect","isSignedIn","get","currentUser","signIn","useLogIn","logOut","signOut","disconnect","useLogOut","isLoading","NavBarUserButton","anchorRef","useRef","isShowingPopover","setIsShowingPopover","ref","IconButton","AccountCircle","Menu","anchorEl","current","open","onClose","MenuItem","disabled","ListItemIcon","minWidth","MeetingRoom","fontSize","DEFAULT_THEME","type","primary","main","blue","secondary","orange","error","red","warning","info","success","green","CustomThemeProvider","devicePalette","useMediaQuery","getItem","setPalette","togglePalette","useCallback","opposite","usePreferredPaletteType","paletteType","useMemo","createMuiTheme","ThemeProvider","TogglePaletteContext","Provider","value","createContext","NavBar","context","useContext","Error","useTogglePaletteContext","AppBar","Toolbar","s2","grow","Brightness4","HomePage","loadable","MemoryPage","StandardPage","ProposalPage","App","exact","path","authLink","setContext","_","headers","authorization","ApolloClient","link","concat","createHttpLink","uri","cache","InMemoryCache","Root","utils","DateFnsUtils","CssBaseline","ReactDOM","render","document","getElementById","GoogleAuthContext","googleAuth","GoogleAuthProvider","gapi","auth2","getAuthInstance","setAuthInstance","load","init","listen","useGoogleAuth","VerticalSpace","spacingProps","flexGrow","flexShrink","HorizontalSpace","s1","s3","s4","s8","s16","undefined"],"mappings":"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","file":"static/js/main.fb628c90.chunk.js","sourcesContent":["export const GOOGLE_CONFIG = {\n  clientId:\n    \"79887996241-lkot8h9s6ehcv4cd07kl9nsugt965pr8.apps.googleusercontent.com\",\n  discoveryDocs: [\"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\"],\n  scope: \"profile\",\n};\nexport const GOOGLE_API_KEY = \"AIzaSyAVLUGVn8ip6SMEpyOGUSZGstOJqArLUxk\";\nexport const GOOGLE_SCOPES = \"https://www.googleapis.com/auth/drive.appdata\";\n","export default function Logo({ size }: { size?: number }) {\n  return (\n    <svg\n      fill=\"currentColor\"\n      width={size ?? \"100%\"}\n      height=\"100%\"\n      viewBox=\"0 0 100 100\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path d=\"M 64.984 8.73 C 76.744 12.943 84.985 22.628 87.624 35.396 C 90.644 50.175 82.029 64.451 67.562 68.665 C 65.55 69.23 62.909 69.607 61.589 69.483 C 59.513 69.293 59.198 69.105 59.198 67.721 C 59.198 66.274 59.513 66.086 62.909 65.709 C 76.682 63.947 86.178 51.244 84.103 37.471 C 82.405 26.779 76.243 18.289 66.746 13.572 C 52.281 6.466 33.225 12.755 26.243 26.968 C 24.42 30.679 23.854 33.068 21.779 45.835 C 21.339 48.854 20.584 50.237 17.376 54.451 C 15.239 57.218 13.665 59.734 13.918 60.111 C 14.105 60.489 15.363 61.369 16.684 62.06 C 19.262 63.319 20.017 64.954 19.451 67.783 C 19.201 69.168 19.451 69.859 20.584 70.803 C 21.904 71.872 21.967 72.186 21.274 73.382 C 20.584 74.513 20.646 74.954 21.842 76.399 C 22.973 77.846 23.099 78.602 22.785 81.683 C 22.281 85.96 22.973 86.589 28.004 86.589 C 32.471 86.589 34.168 84.953 34.985 79.985 C 35.363 77.909 35.613 67.532 35.613 56.967 C 35.613 33.76 36.065 31.921 41.41 26.512 C 45.561 22.363 48.948 21.811 54.796 21.811 C 61.84 21.811 68.631 26.34 71.714 33.068 C 73.538 37.093 73.474 43.822 71.651 47.345 C 67.627 54.892 58.695 57.847 50.897 54.262 C 45.3 51.621 42.155 46.024 42.658 39.357 C 43.098 33.006 47.815 28.728 54.356 28.728 C 58.633 28.728 62.153 30.489 64.292 33.697 C 69.513 41.684 63.915 51.119 55.299 48.728 C 50.834 47.47 47.815 41.874 49.703 38.225 C 52.155 33.509 60.015 35.332 59.387 40.489 C 59.136 42.628 57.186 42.943 56.117 40.992 C 55.739 40.301 55.173 39.546 54.796 39.294 C 53.852 38.603 52.721 39.987 53.035 41.496 C 53.664 43.886 55.173 45.081 57.69 45.081 C 61.84 45.081 63.853 40.992 61.714 36.905 C 60.142 33.887 57.204 32.501 53.684 32.501 C 50.916 32.501 46.132 35.544 46.132 40.301 C 46.132 49.798 56.053 55.206 63.978 50.175 C 67.627 47.911 69.26 44.703 69.198 40.048 C 68.996 28.296 55.633 19.3 43.954 29.168 C 41.421 31.307 39.752 35.747 39.498 41.292 L 39.387 58.853 C 39.073 80.802 39.011 81.998 37.689 84.828 C 35.992 88.6 32.785 90.362 27.69 90.362 C 20.961 90.362 18.069 87.531 18.948 81.872 C 19.262 79.355 19.137 78.854 17.942 77.846 C 16.432 76.652 16.056 74.954 15.93 68.79 C 15.866 66.588 15.552 65.709 14.734 65.457 C 14.169 65.269 12.785 64.325 11.778 63.319 C 8.823 60.615 9.2 58.98 13.854 52.69 C 17.879 47.281 17.942 47.156 18.634 41.621 C 20.143 29.043 22.47 23.51 28.948 17.031 C 33.728 12.315 39.199 9.107 45.236 7.596 C 50.394 6.278 59.576 6.78 64.984 8.73 Z\" />\n    </svg>\n  );\n}\n","import React, { ReactNode } from \"react\";\n\nimport { css } from \"@emotion/css\";\nimport { Button, Typography } from \"@material-ui/core\";\n\ntype Props = {\n  onClick(): void;\n  startIcon?: ReactNode;\n  children: ReactNode;\n};\nexport default function NavBarButtonLayout({ onClick, startIcon, children }: Props) {\n  return (\n    <Button\n      color=\"inherit\"\n      onClick={onClick}\n      startIcon={startIcon}\n      className={css({ textTransform: \"none\" })}\n      disableRipple\n    >\n      <Typography variant=\"h6\">{children}</Typography>\n    </Button>\n  );\n}\n","import React, { ReactNode } from \"react\";\nimport { useHistory, useLocation } from \"react-router-dom\";\n\nimport NavBarButtonLayout from \"./NavBarButtonLayout\";\nimport { css } from \"@emotion/css\";\nimport { useTheme } from \"@material-ui/core\";\n\ntype Props = {\n  route: string;\n  startIcon?: ReactNode;\n  label: string;\n};\nexport default function NavBarRouteButton({ route, startIcon, label }: Props) {\n  const theme = useTheme();\n  const location = useLocation();\n  const history = useHistory();\n  const hasSelectedStyle = location.pathname === route && route !== \"/minder\";\n  return (\n    <NavBarButtonLayout onClick={() => history.push(route)} startIcon={startIcon}>\n      {hasSelectedStyle && (\n        <span\n          className={css({\n            position: \"absolute\",\n            left: theme.spacing(1),\n            right: theme.spacing(1),\n            bottom: -theme.spacing(1),\n            height: 2,\n            backgroundColor: theme.palette.common.white,\n          })}\n        />\n      )}\n      {label}\n    </NavBarButtonLayout>\n  );\n}\n","const ONE_HOUR = 60 * 60;\nconst FIVE_MINUTES = 5 * 60;\nconst FALLBACK_REFRESH_TIME = ONE_HOUR - FIVE_MINUTES;\n\nfunction refreshTime(authResponse: gapi.auth2.AuthResponse) {\n  return (authResponse.expires_in || FALLBACK_REFRESH_TIME) * 1000;\n}\n\nexport default function autoRefreshToken(googleUser: gapi.auth2.GoogleUser): void {\n  const authResponse = googleUser.getAuthResponse(true);\n\n  const refreshToken = async () => {\n    const newAuthRes = await googleUser.reloadAuthResponse();\n    localStorage.setItem(\"token\", newAuthRes.id_token);\n    setTimeout(refreshToken, refreshTime(newAuthRes));\n  };\n\n  setTimeout(refreshToken, refreshTime(authResponse));\n}\n","import { gql, useApolloClient, useMutation } from \"@apollo/client\";\nimport { useEffect, useState } from \"react\";\n\nimport autoRefreshToken from \"./autoRefreshToken\";\nimport { useGoogleAuthContext } from \"./useGoogleAuthProvider\";\n\nexport default function useLoginLogout() {\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const authInstance = useGoogleAuthContext();\n  const logIn = useLogIn({\n    onSuccess: () => setIsLoggedIn(true),\n    onFailure: () => setIsLoggedIn(false),\n  });\n  const logOut = useLogOut({\n    onSuccess: () => setIsLoggedIn(false),\n  });\n  return { logIn, logOut, isLoggedIn, isLoading: authInstance === null };\n}\n\ntype LoginConfig = {\n  onSuccess: () => void;\n  onFailure: () => void;\n};\nfunction useLogIn({ onSuccess, onFailure }: LoginConfig): () => void {\n  const authInstance = useGoogleAuthContext();\n  const client = useApolloClient();\n  const [signin] = useMutation<{ signin: boolean }>(\n    gql`\n      mutation Signin {\n        signin\n      }\n    `,\n  );\n  function onLogin(googleUser: gapi.auth2.GoogleUser) {\n    onSuccess();\n    localStorage.setItem(\"token\", googleUser.getAuthResponse().id_token);\n    client.stop();\n    client\n      .resetStore()\n      .then(() => signin())\n      .then(({ data }) => {\n        if (data?.signin === true) {\n          autoRefreshToken(googleUser);\n        } else {\n          localStorage.setItem(\"token\", \"\");\n          client.resetStore();\n        }\n      });\n  }\n\n  // auto login\n  useEffect(() => {\n    if (authInstance && authInstance.isSignedIn.get()) {\n      onLogin(authInstance.currentUser.get());\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [authInstance]);\n\n  if (!authInstance) {\n    return () => {};\n  }\n\n  return function login() {\n    authInstance.signIn().then(onLogin, onFailure);\n  };\n}\n\ntype LogoutConfig = {\n  onSuccess: () => void;\n};\nfunction useLogOut({ onSuccess }: LogoutConfig): () => void {\n  const authInstance = useGoogleAuthContext();\n  const client = useApolloClient();\n  if (!authInstance) {\n    return () => {};\n  }\n\n  return function logout() {\n    localStorage.setItem(\"token\", \"\");\n    client.resetStore();\n\n    authInstance.signOut().then(() => {\n      authInstance.disconnect();\n      onSuccess();\n    });\n  };\n}\n","import { AccountCircle, MeetingRoom } from \"@material-ui/icons\";\nimport {\n  IconButton,\n  ListItemIcon,\n  Menu,\n  MenuItem,\n  Typography,\n} from \"@material-ui/core\";\nimport React, { useRef, useState } from \"react\";\n\nimport NavBarButtonLayout from \"./NavBarButtonLayout\";\nimport { css } from \"@emotion/css\";\nimport useLoginLogout from \"../../../google-integration/useLoginLogout\";\n\nexport default function NavBarUserButton() {\n  const { logIn, logOut, isLoggedIn, isLoading } = useLoginLogout();\n  const anchorRef = useRef(null);\n  const [isShowingPopover, setIsShowingPopover] = useState(false);\n  return (\n    <>\n      <span ref={anchorRef}>\n        {isLoggedIn ? (\n          <IconButton onClick={() => setIsShowingPopover(true)}>\n            <AccountCircle />\n          </IconButton>\n        ) : (\n          <NavBarButtonLayout onClick={() => setIsShowingPopover(true)}>\n            Log in\n          </NavBarButtonLayout>\n        )}\n      </span>\n      <Menu\n        anchorEl={anchorRef.current}\n        open={isShowingPopover}\n        onClose={() => setIsShowingPopover(false)}\n      >\n        {isLoggedIn ? (\n          <MenuItem\n            onClick={() => {\n              setIsShowingPopover(false);\n              logOut();\n            }}\n            disabled={isLoading}\n          >\n            <ListItemIcon className={css({ minWidth: 36 })}>\n              <MeetingRoom fontSize=\"small\" color=\"action\" />\n            </ListItemIcon>\n            <Typography>Logout</Typography>\n          </MenuItem>\n        ) : (\n          <MenuItem\n            onClick={() => {\n              setIsShowingPopover(false);\n              logIn();\n            }}\n            disabled={isLoading}\n          >\n            <ListItemIcon className={css({ minWidth: 36 })}>\n              <MeetingRoom fontSize=\"small\" color=\"action\" />\n            </ListItemIcon>\n            <Typography>Sign in with Google</Typography>\n          </MenuItem>\n        )}\n      </Menu>\n    </>\n  );\n}\n","import React, {\n  ReactNode,\n  createContext,\n  useCallback,\n  useContext,\n  useMemo,\n  useState,\n} from \"react\";\nimport { ThemeProvider, createMuiTheme, useMediaQuery } from \"@material-ui/core\";\nimport { blue, green, orange, red } from \"@material-ui/core/colors\";\n\nconst DEFAULT_THEME = {\n  palette: {\n    type: \"light\",\n    primary: { main: blue[500] },\n    secondary: { main: orange[\"A100\"] },\n    error: { main: red[500] },\n    warning: { main: orange[500] },\n    info: { main: blue[500] },\n    success: { main: green[500] },\n  },\n};\n\nexport function CustomThemeProvider({ children }: { children?: ReactNode }) {\n  const [paletteType, togglePalette] = usePreferredPaletteType();\n  const theme = useMemo(\n    () =>\n      createMuiTheme({\n        ...DEFAULT_THEME,\n        palette: { ...DEFAULT_THEME.palette, type: paletteType },\n      }),\n    [paletteType],\n  );\n  return (\n    <ThemeProvider theme={theme}>\n      <TogglePaletteContext.Provider value={{ togglePalette }}>\n        {children}\n      </TogglePaletteContext.Provider>\n    </ThemeProvider>\n  );\n}\n\ntype TTogglePaletteContext = { togglePalette(): void };\nconst TogglePaletteContext = createContext<TTogglePaletteContext | null>(null);\nexport function useTogglePaletteContext() {\n  const context = useContext(TogglePaletteContext);\n  if (context == null) {\n    throw new Error(\"missing TogglePaletteContext.Provider\");\n  }\n  return context;\n}\n\nfunction usePreferredPaletteType(): [\"dark\" | \"light\", () => void] {\n  const devicePalette = useMediaQuery(\"(prefers-color-scheme: dark)\")\n    ? \"dark\"\n    : \"light\";\n\n  const [palette, setPalette] = useState(localStorage.getItem(\"palette\"));\n\n  const togglePalette = useCallback(() => {\n    setPalette((current) => {\n      const opposite = current === \"dark\" ? \"light\" : \"dark\";\n      localStorage.setItem(\"palette\", opposite);\n      return opposite;\n    });\n  }, []);\n  switch (palette) {\n    case \"dark\":\n      return [\"dark\", togglePalette];\n    case \"light\":\n      return [\"light\", togglePalette];\n    default:\n      return [devicePalette, togglePalette];\n  }\n}\n","import { AppBar, IconButton, Toolbar, useTheme } from \"@material-ui/core\";\n\nimport { Brightness4 } from \"@material-ui/icons\";\nimport { HorizontalSpace } from \"../Spacing\";\nimport Logo from \"../Logo\";\nimport NavBarRouteButton from \"./NavBarRouteButton\";\nimport NavBarUserButton from \"./NavBarUserButton\";\nimport React from \"react\";\nimport { useTogglePaletteContext } from \"../useTogglePaletteContext\";\n\nexport default function NavBar() {\n  const theme = useTheme();\n  const { togglePalette } = useTogglePaletteContext();\n  return (\n    <AppBar\n      position=\"static\"\n      color={theme.palette.type === \"light\" ? \"primary\" : \"default\"}\n    >\n      <Toolbar>\n        <NavBarRouteButton\n          startIcon={<Logo size={36} />}\n          route=\"/minder\"\n          label=\"Minder\"\n        />\n        <NavBarRouteButton route=\"/minder/memories\" label=\"Memories\" />\n        <NavBarRouteButton route=\"/minder/standard\" label=\"Standard\" />\n        <HorizontalSpace s2 grow />\n        <IconButton onClick={togglePalette}>\n          <Brightness4 />\n        </IconButton>\n        <HorizontalSpace s2 />\n        <NavBarUserButton />\n      </Toolbar>\n    </AppBar>\n  );\n}\n","import { Route, BrowserRouter as Router, Switch } from \"react-router-dom\";\n\nimport NavBar from \"./core/nav-bar/NavBar\";\nimport React from \"react\";\nimport loadable from \"@loadable/component\";\n\nconst HomePage = loadable(() => import(\"./home/HomePage\"));\nconst MemoryPage = loadable(() => import(\"./memory/MemoryPage\"));\nconst StandardPage = loadable(() => import(\"./standard/StandardPage\"));\nconst ProposalPage = loadable(() => import(\"./proposal/ProposalPage\"));\n\nfunction App() {\n  return (\n    <Router>\n      <NavBar />\n      <Switch>\n        <Route exact path=\"/minder/\">\n          <HomePage />\n        </Route>\n        <Route exact path=\"/minder/memories\">\n          <MemoryPage />\n        </Route>\n        <Route path=\"/minder/standard\">\n          <StandardPage />\n        </Route>\n        <Route path=\"/minder/proposal/:proposalId\">\n          <ProposalPage />\n        </Route>\n      </Switch>\n    </Router>\n  );\n}\n\nexport default App;\n","import \"fontsource-roboto\";\n\nimport {\n  ApolloClient,\n  ApolloProvider,\n  InMemoryCache,\n  createHttpLink,\n} from \"@apollo/client\";\n\nimport App from \"./pages/App\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport { CustomThemeProvider } from \"./pages/core/useTogglePaletteContext\";\nimport DateFnsUtils from \"@date-io/date-fns\";\nimport { GoogleAuthProvider } from \"./google-integration/useGoogleAuthProvider\";\nimport { MuiPickersUtilsProvider } from \"@material-ui/pickers\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { setContext } from \"@apollo/client/link/context\";\n\nconst authLink = setContext((_, { headers }) => ({\n  headers: {\n    ...headers,\n    authorization: localStorage.getItem(\"token\") ?? \"\",\n  },\n}));\n\nconst client = new ApolloClient({\n  link: authLink.concat(\n    createHttpLink({\n      uri: \"https://thawing-wildwood-69808.herokuapp.com/graphql\",\n    }),\n  ),\n  cache: new InMemoryCache(),\n});\n\nfunction Root() {\n  return (\n    <ApolloProvider client={client}>\n      <MuiPickersUtilsProvider utils={DateFnsUtils}>\n        <GoogleAuthProvider>\n          <CustomThemeProvider>\n            <CssBaseline />\n            <App />\n          </CustomThemeProvider>\n        </GoogleAuthProvider>\n      </MuiPickersUtilsProvider>\n    </ApolloProvider>\n  );\n}\n\nReactDOM.render(<Root />, document.getElementById(\"root\"));\n","import { ReactNode, createContext, useContext, useState } from \"react\";\n\nimport { GOOGLE_CONFIG } from \"./googleConfiguration\";\n\ntype TGoogleAuthContext = { googleAuth: gapi.auth2.GoogleAuth | null };\nconst GoogleAuthContext = createContext<TGoogleAuthContext>({ googleAuth: null });\n\nfunction useGoogleAuth() {\n  const [authInstance, setAuthInstance] = useState<gapi.auth2.GoogleAuth | null>(\n    gapi.auth2 != null ? gapi.auth2.getAuthInstance() : null,\n  );\n\n  if (gapi.auth2 == null) {\n    gapi.load(\"client:auth2\", () => {\n      gapi.client.init(GOOGLE_CONFIG).then(() => {\n        const authInstance = gapi.auth2.getAuthInstance();\n        authInstance.isSignedIn.listen((isSignedIn) => {\n          const authInstance = gapi.auth2 && gapi.auth2.getAuthInstance();\n          setAuthInstance(authInstance != null ? authInstance : null);\n        });\n        setAuthInstance(authInstance);\n      });\n    });\n  }\n  return authInstance;\n}\n\nexport function useGoogleAuthContext() {\n  const context = useContext(GoogleAuthContext);\n  if (context == null) {\n    throw new Error(\"missing GoogleAuthContext.Provider\");\n  }\n  return context.googleAuth;\n}\n\nexport function GoogleAuthProvider({ children }: { children?: ReactNode }) {\n  const authInstance = useGoogleAuth();\n  return (\n    <GoogleAuthContext.Provider value={{ googleAuth: authInstance }}>\n      {children}\n    </GoogleAuthContext.Provider>\n  );\n}\n","import { css } from \"@emotion/css\";\nimport { useTheme } from \"@material-ui/core\";\n\n/**\n * No component should have styles to distance themselves from other\n * components. This component builds that mindset into code.\n */\ntype Props = {\n  s1?: boolean;\n  s2?: boolean;\n  s3?: boolean;\n  s4?: boolean;\n  s8?: boolean;\n  s16?: boolean;\n  grow?: boolean;\n};\nexport function VerticalSpace({ grow = false, ...spacingProps }: Props) {\n  const theme = useTheme();\n  return (\n    <div\n      className={css({\n        height: theme.spacing(spacing(spacingProps)),\n        flexGrow: grow ? 1 : \"initial\",\n        flexShrink: 0,\n      })}\n    />\n  );\n}\nexport function HorizontalSpace({ grow = false, ...spacingProps }: Props) {\n  const theme = useTheme();\n  return (\n    <span\n      className={css({\n        width: theme.spacing(spacing(spacingProps)),\n        flexGrow: grow ? 1 : \"initial\",\n        flexShrink: 0,\n      })}\n    />\n  );\n}\nfunction spacing({ s1, s2, s3, s4, s8, s16 }: Props) {\n  return (\n    (s1 ? 1 : undefined) ??\n    (s2 ? 2 : undefined) ??\n    (s3 ? 3 : undefined) ??\n    (s4 ? 4 : undefined) ??\n    (s8 ? 8 : undefined) ??\n    (s16 ? 16 : undefined) ??\n    1\n  );\n}\n"],"sourceRoot":""}